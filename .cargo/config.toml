# Cargo workspace configuration.
#
# build-std flags are passed explicitly by the build scripts rather than here,
# to avoid applying them to host-target builds (e.g. cargo test).

# Enable JSON target spec files and set the directory rustc searches for custom
# target specs by triple name (e.g. --target x86_64-seraph-none resolves to
# scripts/targets/x86_64-seraph-none.json). json-target-spec is benign on host
# builds â€” it enables parsing, not forces it.
[unstable]
json-target-spec = true

[env]
RUST_TARGET_PATH = { value = "scripts/targets", relative = true }

[build]
rustflags = ["-Zunstable-options"]

# RISC-V UEFI bootloader link flags.
# The linker script path is relative to the workspace root.
# jump-tables=no avoids generating jump tables that UEFI can't relocate.
[target.riscv64gc-seraph-uefi]
rustflags = [
    "-Zunstable-options",
    "-C", "link-arg=-Tboot/linker/riscv64-uefi.ld",
    "-C", "jump-tables=no",
]
